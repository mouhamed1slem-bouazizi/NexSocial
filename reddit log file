Auth successful for user: mibtn10@gmail.com
📝 Creating new post for user: bef1bbcf-0cf9-4c6b-b486-2e6ce38d5693
📊 Post data: {
  "content": "test agaın for vıdeo after fıxıng",
  "platforms": [
    "reddit"
  ],
  "selectedAccounts": [
    "dee9da15-8ce4-4e20-b0c9-37126dfad9fc"
  ],
  "media": [
    {
      "name": "Sanfara ft @MortadhaFtiti - Dhanbi [Official Music Video]  2025.mp4",
      "type": "video",
      "data": "data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAE88bW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAL6sAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAOmV0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAL4oAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAA
    }
  ],
  "discordChannels": {
    "65b24020-8927-4cfb-9d89-9d2d23e1ff32": "1392079021927305331"
  }
}
Fetching social accounts for user: bef1bbcf-0cf9-4c6b-b486-2e6ce38d5693
Found 6 social accounts for user: bef1bbcf-0cf9-4c6b-b486-2e6ce38d5693
📤 Publishing to 1 accounts: [ 'reddit:suareztn' ]
📎 Processed 1 media files
🚀 Posting to reddit:suareztn...
🔴 Posting to Reddit for account suareztn (attempt 1)
📝 Content: test agaın for vıdeo after fıxıng
📎 Media items: 1
🔍 Parsed metadata: {}
📊 User moderates 0 subreddits
📊 User karma: 0 (link: 0, comment: 0)
🎯 Posting to user profile: r/u_suareztn
📤 Processing 1 media items for Reddit
🔍 Checking media: Sanfara ft @MortadhaFtiti - Dhanbi [Official Music Video]  2025.mp4
   type: "video"
   mimeType: ""
   dataMimeType: ""
   data preview: "NO_DATA"
   data starts with 'data:': undefined
   isImage: false, isVideo: true
📷 Creating video post for Reddit
🎬 Attempting Reddit native video upload for v.redd.it hosting...
🔴 Uploading video to Reddit's native hosting: Sanfara ft @MortadhaFtiti - Dhanbi [Official Music Video]  2025.mp4
📊 Media item structure: {
  hasData: false,
  hasBuffer: true,
  dataType: 'undefined',
  dataPreview: 'NO_DATA',
  bufferLength: 5990632
}
✅ Using existing buffer: 5990632 bytes, MIME: video
📡 Requesting Reddit upload URL with MIME type: video/mp4...
✅ Got Reddit upload data: {
  args: {
    action: '//reddit-uploaded-video.s3-accelerate.amazonaws.com',
    fields: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  },
  asset: {
    asset_id: 'vrzw3o6fr6cf1',
    processing_state: 'incomplete',
    payload: {
      filepath: 'Sanfara ft @MortadhaFtiti - Dhanbi [Official Music Video]  2025.mp4'
    },
    websocket_url: 'wss://k8s-lb.wss.redditmedia.com/vrzw3o6fr6cf1?m=AQAAvKtwaCn5v8FJF7R1N46_NzLPCu1ZVpBXl7-_OIrAk96hP0tt'
  }
}
❌ Reddit native video upload failed: TypeError: source.on is not a function
    at DelayedStream.create (/opt/render/project/src/server/node_modules/delayed-stream/lib/delayed_stream.js:33:10)
    at CombinedStream.append (/opt/render/project/src/server/node_modules/combined-stream/lib/combined_stream.js:45:37)
    at FormData.append (/opt/render/project/src/server/node_modules/form-data/lib/form_data.js:77:3)
⚠️ Reddit native video upload failed, falling back to Imgur: source.on is not a function
    at /opt/render/project/src/server/routes/postRoutes.js:2063:24
    at Array.forEach (<anonymous>)
    at uploadVideoToRedditNative (/opt/render/project/src/server/routes/postRoutes.js:2062:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async attemptRedditPost (/opt/render/project/src/server/routes/postRoutes.js:2239:41)
    at async postToReddit (/opt/render/project/src/server/routes/postRoutes.js:2624:12)
    at async /opt/render/project/src/server/routes/postRoutes.js:118:22
📤 Uploading video to Imgur: Sanfara ft @MortadhaFtiti - Dhanbi [Official Music Video]  2025.mp4
📊 Base64 video length: 7987512 characters
✅ Successfully uploaded video to Imgur: https://i.imgur.com/3xQS0Os.mp4
✅ Created Imgur fallback video text post with embedded URL: https://i.imgur.com/3xQS0Os.mp4
📤 Submitting self post to Reddit with data: {
  api_type: 'json',
  kind: 'self',
  sr: 'u_suareztn',
  title: 'test agaın for vıdeo after fıxıng',
  text: 'test agaın for vıdeo after fıxıng\n' +
    '\n' +
    '🎬 **Watch Video:** https://i.imgur.com/3xQS0Os.mp4',
  sendreplies: true,
  validate_on_submit: true,
  nsfw: false,
  spoiler: false
}
🔑 Using access token: eyJhbGciOi...
📊 Reddit submit response status: 200
📊 Reddit submit response headers: {
  'accept-ranges': 'bytes',
  'cache-control': 'private, s-maxage=0, max-age=0, must-revalidate, no-store',
  connection: 'keep-alive',
  'content-encoding': 'gzip',
  'content-type': 'application/json; charset=UTF-8',
  date: 'Fri, 11 Jul 2025 06:04:21 GMT',
  expires: '-1',
  nel: '{"report_to": "w3-reporting-nel", "max_age": 14400, "include_subdomains": false, "success_fraction": 1.0, "failure_fraction": 1.0}',
  'report-to': '{"group": "w3-reporting-nel", "max_age": 14400, "include_subdomains": true,  "endpoints": [{ "url": "https://w3-reporting-nel.reddit.com/reports" }]}, {"group": "w3-reporting", "max_age": 14400, "include_subdomains": true, "endpoints": [{ "url": "https://w3-reporting.reddit.com/reports" }]}, {"group": "w3-reporting-csp", "max_age": 14400, "include_subdomains": true, "endpoints": [{ "url": "https://w3-reporting-csp.reddit.com/reports" }]}',
  server: 'snooserv',
  'set-cookie': 'edgebucket=9JazATSrU6pJHXh7cG; Domain=reddit.com; Max-Age=63071999; Path=/;  secure',
  'strict-transport-security': 'max-age=31536000; includeSubdomains',
  'transfer-encoding': 'chunked',
  vary: 'Accept-Encoding',
  via: '1.1 varnish',
  'x-content-type-options': 'nosniff',
  'x-frame-options': 'SAMEORIGIN',
  'x-ratelimit-remaining': '998.0',
  'x-ratelimit-reset': '338',
  'x-ratelimit-used': '2',
  'x-ua-compatible': 'IE=edge',
  'x-xss-protection': '1; mode=block'
}
📊 Reddit submit response body (first 500 chars): {"json": {"errors": [], "data": {"url": "https://www.reddit.com/r/u_suareztn/comments/1lwzcpl/test_aga\u0131n_for_v\u0131deo_after_f\u0131x\u0131ng/", "drafts_count": 0, "id": "1lwzcpl", "name": "t3_1lwzcpl"}}}
📊 Reddit submit parsed data: {
  "json": {
    "errors": [],
    "data": {
      "url": "https://www.reddit.com/r/u_suareztn/comments/1lwzcpl/test_agaın_for_vıdeo_after_fıxıng/",
      "drafts_count": 0,
      "id": "1lwzcpl",
      "name": "t3_1lwzcpl"
    }
  }
}
✅ Posted to Reddit successfully
📊 Post details: ID=1lwzcpl, URL=https://reddit.comhttps://www.reddit.com/r/u_suareztn/comments/1lwzcpl/test_agaın_for_vıdeo_after_fıxıng/